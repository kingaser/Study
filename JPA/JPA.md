## JPA

JPA는 자바에서 데이터를 관리하고 영속성을 지원하기 위한 API. JPA는 관계형 데이터베이스와의 상호 작용을 간소화하고 객체 지향 프로그래밍의 장점을 활용할 수 있도록 도와줌

### 특징 및 개념

- 객체-관계 매핑(Object-Relational Mapping, ORM)
    - JPA는 자바 객체와 관계형 데이터베이스 테이블 간의 매핑을 지원. 이를 통해 개발자는 객체를 사용하여 데이터베이스와 상호 작용할 수 있음
- 애노테이션 기반 설정
    - JPA에서는 주로 애노테이션을 사용하여 객체와 데이터베이스 간의 매핑을 정의. 이를 통해
      개발자는 별도의 XML 파일을 작성하지 않고도 간편하게 설정할 수 있음
- 영속성 컨텍스트(Persistence Content)
    - JPA에서는 영속성 컨텍스트를 사용하여 엔티티 객체의 생명주기를 관리. 영속성 컨텍스트는 데이터베이스와의 트랜잭션 범위에서 엔티티를 관리하며, 변경 사항을 추적하고 데이터베이스에 반영
- 트랜잭션 관리
    - JPA는 데이터베이스 트랜잭션을 지원하여 일관성 있는 상태를 유지. 트랜잭션을 시작하고 커밋 또는 롤백하는 등의 작업을 제공
- 다양한 구현체
    - JPA는 표준 인터페이스이며, 이를 구현한 다양한 제품들이 있음. 가장 널리 사용되는 구현체 중 하나는 Hibernate. 다른 구현체로는 EclipseLink, Apache OpenJPA등이 있음

JPA를 사용하면 개발자는 데이터베이스와의 상호 작용에 대한 복잡한 코드를 작성하지 않아도 되며, 객체 지향적인 코드로 데이터베이스를 다룰 수 있음. 이를 통해 생산성을 향상시키고 유지보수성을 높일 수 있음

## JPA는 표준 명세

- JPA는 인터페이스의 모음
- JPA 2.1 표준 명세를 구현한 3가지 구현체
- 하이버네이트, EclipseLink, DataNucleus
- SQL 중심적인 개발에서 객체 중심으로 개발
- 생산성, 유지보수, 페러다임의 불일치 해결
- 성능
- 데이터 접근 추상화와 벤더 독립성
- 표준
- 상속, 연관관계, 객체그래프 탐색, 신뢰할 수 있는 엔티티, 계층
- 동일한 트랜잭션에서 조회한 엔티티는 같음을 보장 (==)
- 1차 캐시와 동일성 보장

  같은 트랜잭션 안에서는 같은 엔티티를 반환 - 약간의 조회 성능 향상

  DB Isolation Level이 Read Commit이어도 애플리케이션에서 Repeatable Read보

- 트랜잭션을 지원하는 쓰기 지연

  INSERT - 트랜잭션을 커밋할 때까지 INSERT SQL을 모음

  JDBC BATCH SQL 기능을 사용해서 한번에 SQL전송

  UPDATE - UPDATE, DELETE로 인한 로우(ROW)락 시간 최소화

  트랜잭션 커밋 시 UPDATE, DELETE SQl실행하고, 바로 커밋

- 지연 로딩: 객체가 실제 사용될 때 로딩
- 즉시 로딩: JOIN SQL로 한번에 객체까지 미리 조회
- ORM은 객체와 RDB 두 기둥위에 있는 기

## 주의

엔티티 매니저 팩토리는 하나만 생성해서 애플리케이션 전체에서 공유

엔티티 매니저는 쓰레드간에 공유하면 안된다(사용하고 버려야 한다.)

JPA의 모든 데이터 변경은 트랜잭션 안에서 실행